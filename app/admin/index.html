<!DOCTYPE html>
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--><html lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <title>index</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link href="assets/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/style-responsive.css" rel="stylesheet" />
    <link href="css/style-default.css" rel="stylesheet" id="style_color" />
    <link href="css/page.css" rel="stylesheet" type="text/css"/>
</head>

<body class="fixed-top">


    <!-- begin header -->
    <div id="header" class="navbar navbar-inverse navbar-fixed-top">
       <div class="navbar-inner">
           <div class="container-fluid">



               <!--sidebar toggle-->
               <div class="sidebar-toggle-box hidden-phone">
                   <div class="icon-reorder tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
               </div>


               <!-- LOGO -->
               <a class="brand" href="index.html">
                   <h1>LOGO</h1>
               </a>

               <a class="btn btn-navbar collapsed" id="main_menu_trigger" data-toggle="collapse" data-target=".nav-collapse">
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="arrow"></span>
               </a>


               <!-- user avatar -->
               <div class="top-nav">
                   <ul class="nav pull-right top-menu" >

                       <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                              <span class="username">Jhon Doe</span>
                              <b class="caret"></b>
                              <img src="img/avatar1_small.jpg" class="logined" alt="">
                           </a>
                           <ul class="dropdown-menu extended logout">
                              <li>
                                  <a href="personal-center.html"><i class="icon-key"></i>个人中心</a>
                              </li>
                              <li>
                                  <a href="login.html"><i class="icon-key"></i>退出</a>
                              </li>
                           </ul>
                       </li>
                       <li>
                            <a href="#">
                               <img src="img/avatar.png" class="login-before" alt="">
                            </a>
                       </li>
                   </ul>
               </div>


           </div>
       </div>
    </div>
    <!-- end header -->




  <!-- BEGIN CONTAINER -->
  <div id="container" class="row-fluid">



      <!-- begin slidebar -->
      <div class="sidebar-scroll">
          <div id="sidebar" class="nav-collapse collapse">

            <ul class="sidebar-menu">

                <li class="sub-menu active">
                    <a class="" href="index.html">
                        <i class="icon-dashboard"></i>
                        <span>活动列表</span>
                    </a>
                </li>

                <li class="sub-menu">
                    <a class="" href="monitor-people.html">
                        <i class="icon-dashboard"></i>
                        <span>监测人列表</span>
                    </a>
                </li>

                <li class="sub-menu">
                    <a class="" href="pw-change.html">
                        <i class="icon-dashboard"></i>
                        <span>密码修改</span>
                    </a>
                </li>
                
            </ul>

        </div>
      </div>
      <!-- end slidebar -->






      <!-- begin 中间内容区-->  
      <div id="main-content" class="container-fluid index-mc">
        
          <h3 class="page-title">活动列表</h3>


          <div class="task-at-title row-fluid">
            
              <div class="span6"></div>

              <div class="span6">
                  <button class="btn btn-large btn-warning create-at"><i class="icon-plus icon-white"></i> 创建活动</button>
              </div>

          </div>


          <div class="widget-body activity-list">
              <table class="table table-bordered">
                  <thead>
                  <tr>
                      <th>活动名称</th>
                      <th>周期</th>
                      <th>广告主</th>
                      <th>品牌</th>
                      <th>任务数量</th>
                      <th>活动阶段</th>
                      <th>操作</th>
                  </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td>活动1</td>
                          <td>2017.01.01 - 2017.12.30</td>
                          <td>耐克专卖店耐克专卖店耐克专卖店耐克专卖店</td>
                          <td>耐克</td>
                          <td>2</td>
                          <td>4</td>
                          <td>
                              <button class="btn btn-primary at-detail-btn">详情</button>
                              <button class="btn btn-danger"><a href="task-list.html">任务</a></button>
                          </td>
                      </tr>
                  </tbody>
              </table>
          </div>


      </div>
      <!-- end  中间内容区-->  



  </div>
  <!-- END CONTAINER-->





  <div id="footer">
     ©2017 20170331170544
  </div>




<script src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="assets/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/uniform/jquery.uniform.min.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/laydate/laydate.js"></script>
<script type="text/javascript" src="js/laypage/laypage.js"></script>
<script src="js/jquery.scrollto.min.js"></script>
<!--common script for all pages-->
<script src="js/common-scripts.js"></script>

<script type="text/javascript">
  

var atHtml = '<form class="OOHM-layer-form" action="javascript:;">' + 

    '<div class="OOHM-layer-list OOHM-name"><label class="label-title">活动名称：</label><div class="form-content"><input type="text" placeholder="活动名称" /></div></div>' +

    '<div class="OOHM-layer-list OOHM-period"><label class="label-title">周期：</label><div class="form-content"><input type="text" id="periodStart" placeholder="开始日期" /> <span class="zhiorto">至</span> <input type="text" id="periodEnd" placeholder="结束日期"  /></div></div>' +

    '<div class="OOHM-layer-list OOHM-adc"><label class="label-title">广告主：</label><div class="form-content"><input type="text" placeholder="广告主" /></div></div>' +

    '<div class="OOHM-layer-list OOHM-brand"><label class="label-title">品牌：</label><div class="form-content"><input type="text" placeholder="品牌" /></div></div>' +

    '<div class="OOHM-layer-list OOHM-stage"><label class="label-title">活动阶段：</label><div class="form-content">' + 

          '<div class="add-stage"><button class="btn btn-small btn-warning" id="addStage">添加</button></div>' + 

          '<div class="at-table-wrap"><table class="table table-bordered at-stage-table"><thead><tr><th width="25%">阶段名称</th><th>时间范围</th><th width="15%">操作</th></tr></thead><tbody><tr><td><input type="text" value="上刊"></td><td><input type="text" class="at-date-s" id="atDates00" value="2017-01-01"> - <input type="text" class="at-date-e" value="2017-1-31" id="atDates01" ></td><td><button class="btn btn-small btn-danger at-delete" type="button">删除</button></td></tr><tr><td><input type="text" value="上刊"></td><td><input type="text" class="at-date-s" id="atDates10" value="2017-01-01"> - <input type="text" class="at-date-e" value="2017-1-31" id="atDates11" ></td><td><button class="btn btn-small btn-danger at-delete" type="button">删除</button></td></tr><tr><td><input type="text" value="上刊"></td><td><input type="text" class="at-date-s" id="atDates20" value="2017-01-01"> - <input type="text" class="at-date-e" value="2017-1-31" id="atDates21" ></td><td><button class="btn btn-small btn-danger at-delete" type="button">删除</button></td></tr></tbody></table></div>' +

    '</div></div>' +

    '<div class="OOHM-layer-list OOHM-btn"><label class="label-title"></label><div class="form-content at-save-fc"><button class="btn  btn-success" id="atSave" type="button">保存</button></div></div>' +

   '</form>';

   // 创建活动
   $('.create-at').click(function() {
      atCreateDetail('创建活动')
   })

   // 活动详情
   $('.at-detail-btn').click(function() {
      atCreateDetail('活动详情')
   })

  function atCreateDetail(title) {
    var layerMask = layer.open({
        type: 1,
        title: '<div>' + title + '</div>',
        skin: 'adminLogin', //加上边框
        area: ['640px', '540px'], //宽高
        // scrollbar: false,
        content: atHtml
      });
      function layerClose(){layer.close(layerMask);}


      // 日期
      var periodStartDate = {
         elem: '#periodStart',
         choose: function(datas){
          periodEndDate.min = datas //将结束日的初始值设定为开始日
         }
      };
      var periodEndDate = {
         elem: '#periodEnd',
         choose: function(datas){
            periodStartDate.max = datas; //结束日选好后，重置开始日的最大日期
         }
      }
      $('#periodStart').focus(function() {
        laydate(periodStartDate);
      })
      $('#periodEnd').focus(function() {
        laydate(periodEndDate);
      })


      // 活动阶段时间范围
      $('.at-stage-table tbody tr').each(function() {
          addNewDate($(this));
      })

      // 添加活动阶段
      $('#addStage').click(function() {
          var validateReturn = atValidate();
          if(!validateReturn) {
              return;
          }
          var atTbody = $('.at-stage-table');
          var trCurLenght = atTbody.find('tr').length;
          var apHtml = '<tr><td><input type="text" placeholder="活动阶段"></td><td><input type="text" class="at-date-s" id="atDates' + trCurLenght + '0" placeholder="开始时间"> - <input type="text" class="at-date-e" placeholder="结束时间" id="atDates' + trCurLenght + '1" ></td><td><button class="btn btn-small btn-danger at-delete" type="button">删除</button></td></tr>';
          atTbody.append(apHtml);
          addNewDate(atTbody.find('tr').eq(trCurLenght));
          return false;
      })

      // 活动保存
      $('#atSave').click(function() {
          var validateReturn = atValidate();
          if(!validateReturn) {
              return;
          } else {
              layer.msg('保存成功！');
              layerClose();
          }
      })

      // 活动删除
      $('.at-stage-table').on('click', '.at-delete', function() {
          var _this = $(this);
          var layerDel = layer.confirm('确定删除？', {
            btn: ['确定','取消'] //按钮
          }, function(){
            layer.close(layerDel);
            _this.parents('tr').remove();
            layer.msg('删除成功!');
          }, function(){
          });
      })
  }


   function addNewDate(objArg) {
      var atDateStart = objArg.find('.at-date-s').eq(0);
      var atDateStartID = objArg.find('.at-date-s').eq(0).prop('id');

      var atDateEnd = objArg.find('.at-date-e').eq(0);
      var atDateEndID = objArg.find('.at-date-e').eq(0).prop('id');


      var dateStartDate = {
         elem: '#' + atDateStartID,
         choose: function(datas){
          dateEndDate.min = datas //将结束日的初始值设定为开始日
         }
      };
      var dateEndDate = {
         elem: '#' + atDateEndID,
         choose: function(datas){
            dateStartDate.max = datas; //结束日选好后，重置开始日的最大日期
         }
      }
      atDateStart.focus(function() {
        laydate(dateStartDate);
      })
      atDateEnd.focus(function() {
        laydate(dateEndDate);
      })
   }

   
   // 表单验证不为空 
   function atValidate() {
      var atValidateV = true;
      $('.OOHM-layer-list').not('.OOHM-stage, .OOHM-btn').find('input[type=text]').each(function() {
          if($(this).val() == '') {
             layer.msg($(this).parents('.OOHM-layer-list').find('.label-title').text().replace('：', '') + '不能为空！')
             $(this).focus();
             atValidateV = false;
             return false;
          }
      })
      $('.at-stage-table tr').find('input[type=text]').each(function() {
          if($(this).val() == '') {
             layer.msg('活动阶段填写不完整！');
             $(this).focus();
             atValidateV = false;
             return false;
          }
      })
      return atValidateV;
   }



</script>

</body>
</html>
