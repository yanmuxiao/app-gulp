<!DOCTYPE html>
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--><html lang="en"> <!--<![endif]-->
<head>
    <meta charset="utf-8"/>
    <title>index</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link href="assets/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/style-responsive.css" rel="stylesheet" />
    <link href="css/style-default.css" rel="stylesheet" id="style_color" />
    <link href="css/page.css" rel="stylesheet" type="text/css"/>
    <link href="css/willesPlay.css" rel="stylesheet" type="text/css"/>
</head>

<body class="fixed-top">


    <!-- begin header -->
    <div id="header" class="navbar navbar-inverse navbar-fixed-top">
       <div class="navbar-inner">
           <div class="container-fluid">



               <!--sidebar toggle-->
               <div class="sidebar-toggle-box hidden-phone">
                   <div class="icon-reorder tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
               </div>


               <!-- LOGO -->
               <a class="brand" href="index.html">
                   <h1>LOGO</h1>
               </a>

               <a class="btn btn-navbar collapsed" id="main_menu_trigger" data-toggle="collapse" data-target=".nav-collapse">
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="arrow"></span>
               </a>


               <!-- user avatar -->
               <div class="top-nav">
                   <ul class="nav pull-right top-menu" >

                       <li class="dropdown">
                           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                              <span class="username">Jhon Doe</span>
                              <b class="caret"></b>
                              <img src="img/avatar1_small.jpg" class="logined" alt="">
                           </a>
                           <ul class="dropdown-menu extended logout">
                              <li>
                                  <a href="personal-center.html"><i class="icon-key"></i>个人中心</a>
                              </li>
                              <li>
                                  <a href="login.html"><i class="icon-key"></i>退出</a>
                              </li>
                           </ul>
                       </li>
                       <li>
                            <a href="#">
                               <img src="img/avatar.png" class="login-before" alt="">
                            </a>
                       </li>
                   </ul>
               </div>


           </div>
       </div>
    </div>
    <!-- end header -->




  <!-- BEGIN CONTAINER -->
  <div id="container" class="row-fluid">



      <!-- begin slidebar -->
      <div class="sidebar-scroll">
          <div id="sidebar" class="nav-collapse collapse">

            <ul class="sidebar-menu">

                <li class="sub-menu">
                    <a class="" href="index.html">
                        <i class="icon-dashboard"></i>
                        <span>活动列表</span>
                    </a>
                </li>

                <li class="sub-menu active">
                    <a class="" href="monitor-people.html">
                        <i class="icon-dashboard"></i>
                        <span>监测人列表</span>
                    </a>
                </li>

                <li class="sub-menu">
                    <a class="" href="pw-change.html">
                        <i class="icon-dashboard"></i>
                        <span>密码修改</span>
                    </a>
                </li>

                
            </ul>

        </div>
      </div>
      <!-- end slidebar -->






      <!-- begin 中间内容区-->  
      <div id="main-content" class="container-fluid view-picture-mc">
        
          <h3 class="page-title">图片查看</h3>

          <div class="widget-body view-picture">

              <div class="picture-info">
                  <ul>
                    <li>活动名称：<span>活动1</span></li>
                    <li>广告主：<span>耐克专卖店</span></li>
                    <li>品牌：<span>耐克</span></li>
                  </ul>
              </div>
              <div class="untreated-picture untreated" id="untreated">
                  <h4>未处理：</h4>
                  <ul class="untreated-pic-ul">
                      <li class="untreated-pic-list">
                        <div class="pic-stage-w">
                            <div class="pic-stage-on" dataType="unStage">未处理</div>
                        </div>
                        <div class="untreated-pic">
                            <div class="untreated-pic-w">
                                <img src="img/4px.png" class="px4">
                                <img src="img/zoomFullScreen.jpg" id="01" class="img-label">
                            </div>
                            <div class="untreaded-d-w">
                                <p class="untreated-pic-info">李某某 <br> 2017-03-13 21:28:45</p>
                                <button class="btn btn-small btn-info treated-detail" type="button">详情</button>
                            </div>
                        </div>


                      </li>
                      <li class="untreated-pic-list">
                        <div class="pic-stage-w">
                            <div class="pic-stage-on" dataType="unStage">未处理</div>
                        </div>
                        <div class="untreated-pic">
                            <div class="untreated-pic-w">
                                <img src="img/4px.png" class="px4">
                                <img src="img/img-list01.jpg" id="02" videoUrl="hb.mp4" class="img-label">
                            </div>
                            <div class="untreaded-d-w">
                                <p class="untreated-pic-info">李某某 <br> 2017-03-13 21:28:45</p>
                                <button class="btn btn-small btn-info treated-detail" type="button">详情</button>
                            </div>
                        </div>
                      </li>
                  </ul>
              </div>

              <div class="untreated-picture treated"  id="treated">
                  <h4>已处理：</h4>
                  <ul class="untreated-pic-ul">
                      <li class="untreated-pic-list">
                        <div class="pic-stage-w">
                            <div class="pic-stage-on" dataType="passStage">通过</div>
                        </div>
                        <div class="untreated-pic">
                            <div class="untreated-pic-w">
                                <img src="img/4px.png" class="px4">
                                <img src="img/zoomFullScreen.jpg" id="03" class="img-label">
                            </div>
                            <div class="untreaded-d-w">
                                <p class="untreated-pic-info">李某某 <br> 2017-03-13 21:28:45</p>
                                <button class="btn btn-small btn-info treated-detail" type="button">详情</button>
                            </div>
                        </div>
                      </li>
                      <li class="untreated-pic-list">
                        <div class="pic-stage-w">
                            <div class="pic-stage-on" dataType="minedStage">待定</div>
                        </div>
                        <div class="untreated-pic">
                            <div class="untreated-pic-w">
                                <img src="img/4px.png" class="px4">
                                <img src="img/img-list01.jpg" videoUrl="hb1.mp4" id="04" class="img-label">
                            </div>
                            <div class="untreaded-d-w">
                                <p class="untreated-pic-info">李某某 <br> 2017-03-13 21:28:45</p>
                                <button class="btn btn-small btn-info treated-detail" type="button">详情</button>
                            </div>
                        </div>
                      </li>
                      <li class="untreated-pic-list">
                        <div class="pic-stage-w">
                            <div class="pic-stage-on" dataType="uneffectStage">无效</div>
                        </div>
                        <div class="untreated-pic">
                            <div class="untreated-pic-w">
                                <img src="img/4px.png" class="px4">
                                <img src="img/zoomFullScreen.jpg" id="05" class="img-label">
                            </div>
                            <div class="untreaded-d-w">
                                <p class="untreated-pic-info">李某某 <br> 2017-03-13 21:28:45</p>
                                <button class="btn btn-small btn-info treated-detail" type="button">详情</button>
                            </div>
                        </div>
                      </li>
                  </ul>
                  
              </div>
              
          </div>
      </div>
      <!-- end  中间内容区-->  



  </div>
  <!-- END CONTAINER-->
  
  
  <!-- 查看大图 -->
  <div class="view-pic-mask">
    
    <div class="view-pic-w">
        <div class="view-pic-pv">

            <span class="view-pic-clons"><i class="icon-remove icon-white"></i></span>

            <span class="pvPrev" id="pvPrev"></span>

  
            <div class="view-stage-w">状态：<span class="view-stage" dataType="passStage">未处理</span></div>
            <div class="pic-w" id="openBigImg">


                <img src="img/img-list01.jpg" class="view-img" id="">

        
                <div class="container" id="videoWrap">
                    <div class="row">
                      <div class="col-md-12">
                        <div id="willesPlay">
                            <div class="playHeader">
                              <div class="videoName">Tara - 懂的那份感觉</div>
                            </div>
                            <div class="playContent">
                              <video width="100%" height="400px" id="playVideo">
                                <source src="hb.mp4" type="video/mp4"></source>
                                当前浏览器不支持 video直接播放，点击这里下载视频： <a href="/">下载视频</a>
                              </video>
                              <div class="playTip glyphicon glyphicon-play"></div>
                            </div>
                            <div class="playControll">
                              <div class="playPause playIcon"></div>
                              <div class="timebar">
                                <span class="currentTime">0:00:00</span>
                                <div class="progress">
                                  <div class="progress-bar progress-bar-danger progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
                                  </div>
                                <span class="duration">0:00:00</span>
                              </div>
                              <div class="otherControl">
                                <span class="volume glyphicon glyphicon-volume-down"></span>
                                <span class="fullScreen glyphicon glyphicon-fullscreen"></span>
                                <div class="volumeBar">
                                    <div class="volumewrap">
                                      <div class="progress">
                                      <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 8px;height: 40%;"></div>
                                    </div>
                                      </div>
                                  </div>
                              </div>
                            </div>
                          </div>
                        
                      </div>
                    </div>
                  </div>





            </div>

            <span class="pvNext" id="pvNext"></span>

        </div>
        <div class="view-psmall">
            <div class="view-pic-small-w">
                <span class="pv-s-prev"></span>
                <div class="view-pic-small">
                  <div class="pv-small-scroll" id="pvSmallScroll"></div>
                </div>
                <span class="pv-s-next"></span>
            </div>
        </div>
        <div></div>
    </div>

  </div>




  <div id="footer">
     ©2017 20170331170544
  </div>




<script src="js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="assets/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/uniform/jquery.uniform.min.js"></script>
<script type="text/javascript" src="js/layer/layer.js"></script>
<script type="text/javascript" src="js/laydate/laydate.js"></script>
<script type="text/javascript" src="js/laypage/laypage.js"></script>
<script type="text/javascript" src="js/viewer-jquery.min.js"></script>
<script type="text/javascript" src="js/willesPlay.js"></script>
<script src="js/jquery.scrollto.min.js"></script>
<!--common script for all pages-->
<script src="js/common-scripts.js"></script>
<script>


    // 未处理的图片状态为未处理
    // 处理过的图片不能在切换会未处理，有待定、通过、无效三种状态
    
    // 图片状态切换
    $('.untreated-pic-ul').on('click', '.pic-stage-on', function() {

        if ($(this).attr('dataType') == 'minedStage') {

            $(this).attr('dataType', 'passStage').text('通过');
            layer.msg('图片id为' + $(this).parents('.untreated-pic-list').eq(0).find('.img-label').prop('id')  + '的状态切换为通过');

        } else if ($(this).attr('dataType') == 'passStage') {

            $(this).attr('dataType', 'uneffectStage').text('无效');
            layer.msg('图片id为' + $(this).parents('.untreated-pic-list').eq(0).find('.img-label').prop('id')  + '的状态切换为无效');

        } else {

            $(this).attr('dataType', 'minedStage').text('待定');
            layer.msg('图片id为' + $(this).parents('.untreated-pic-list').eq(0).find('.img-label').prop('id')  + '的状态切换为待定');

        }

    })


    // 查看图片顶部切换状态
    $('.view-stage').click(function() {

        if ($(this).attr('dataType') == 'minedStage') {

            $(this).attr('dataType', 'passStage').text('通过');
            $('.pv-s-on > img').attr('dataType', 'passStage');//同步切换小图的状态
            layer.msg('图片id为' + $(this).parents('.view-pic-pv').eq(0).find('.view-img').prop('id')  + '的状态切换为通过');

        } else if ($(this).attr('dataType') == 'passStage') {

            $(this).attr('dataType', 'uneffectStage').text('无效');
            $('.pv-s-on > img').attr('dataType', 'uneffectStage');//同步切换小图的状态
            layer.msg('图片id为' + $(this).parents('.view-pic-pv').eq(0).find('.view-img').prop('id')  + '的状态切换为无效');

        } else {

            $(this).attr('dataType', 'minedStage').text('待定');
            $('.pv-s-on > img').attr('dataType', 'minedStage');//同步切换小图的状态
            layer.msg('图片id为' + $(this).parents('.view-pic-pv').eq(0).find('.view-img').prop('id')  + '的状态切换为待定');

        }

        // 列表中的状态也改变
        $('.untreated-pic-list').eq($('.s-img-w').index($('.pv-s-on'))).find('.pic-stage-on').attr('dataType', $(this).attr('dataType')).text($(this).text())

    })



    // 查看图片详情
    var picDetailHtml = '<div class="the-pic-detail"><ul>' +
      
        '<li><p>角度：<span>正面</span></p></li>' +
        '<li><p>监测人：<span>李某某</span></p></li>' +
        '<li><p>拍摄日期：<span>2017-03-21 21:28:45</span></p></li>' +
        '<li><p>拍摄说明：<span>拍摄时间为晚上，照片色彩受光照影响。拍摄时间为晚上，照片色彩受光照影响。拍摄时间为晚上，照片色彩受光照影响。拍摄时间为晚上，照片色彩受光照影响。</span></p></li>' +
        '<li><p>地址：<span>白云机场路136号</span></p></li>' +
        '<li><p>提交日期：<span>2017-03-31 22:48:45</span></p></li>'
      
    + '</ul></div>'
    $('.untreated-pic-ul').on('click', '.treated-detail', function(){
      var layerMask = layer.open({
        type: 1,
        title: '<div>图片详情</div>',
        skin: 'adminLogin', //加上边框
        area: ['500px', 'auto'], //宽高
        // scrollbar: false,
        shadeClose: true,
        content: picDetailHtml
      });
      function layerClose(){layer.close(layerMask);}
    })




    // 关闭查看大图
    $('.view-pic-clons').click(function() {
        $('.view-pic-mask').hide();
    })
    // 点击图片查看大图
    $('.untreated-pic-ul').on('click', '.img-label', function() {
        $('.view-pic-mask').show();
        viewPicFn($(this).prop('id'));
    })


    function viewPicFn(_thisID) {
      
      var curId = _thisID;// 当前大图的id，也就是点击的图片
      

      // 所有的小图
      var imgList = [];
      

      $('.img-label').each(function() {

          var imgListObj = {};
          imgListObj.imgSrc = $(this).prop('src');
          imgListObj.imgId = $(this).prop('id');
          imgListObj.videoUrl = $(this).attr('videoUrl');
          imgListObj.imgStage = $(this).parents('.untreated-pic-list').find('.pic-stage-on').attr('datatype');
          imgList.push(imgListObj);
      })


      var smallImg = []; // 将小图的信息嵌入对应的html放到对应的容器
      var curImg = ''; // 当前大图对应小图的选中状态
      var imgIndex; // 当前大图对应的小图的索引
      $.each(imgList,function(){
          if(this.imgId == curId){
              curImg = 'pv-s-on';
          }else{
              curImg = '';
          }
          smallImg.push('<div class="s-img-w ' + curImg + '"><img id="' + this.imgId + '" dataType="' + this.imgStage + '" videoUrl="' + this.videoUrl + '" src="' + this.imgSrc +'" /></div>')
      })




      $('#pvSmallScroll').html(smallImg.join(''));
      var pvSmallImg = $('#pvSmallScroll .s-img-w');
      var pvSmallImgLength = pvSmallImg.length;
      var pvScrollW = 0;
      if(pvSmallImg.length > 7){
          pvScrollW = pvSmallImgLength * 56;
          $('#pvSmallScroll').width(pvScrollW + 'px');
      }




      imgIndex = $('.s-img-w').index($('.pv-s-on'));
      // 当前图片为第一个，隐藏切换(prev)
      if(imgIndex == 0){
          $('#pvPrev').hide();
      }else{
          $('#pvPrev').show();
      }
      // 当前图片为最后一个，隐藏切换(next)
      if(imgIndex == pvSmallImgLength-1){
          $('#pvNext').hide();
      }else{
          $('#pvNext').show();
      }
      


      $('#pvSmallScroll .s-img-w').click(function(){
          imgIndex = pvSmallImg.index($(this));
          if(pvSmallImgLength > 7){
              if(imgIndex <= 3){
                  $('.pv-s-prev').hide();
              }else{
                  $('.pv-s-prev').show();
              }
              if(imgIndex >= pvSmallImgLength-4){
                  $('.pv-s-next').hide();
              }else{
                  $('.pv-s-next').show();
              }
          }else{
              $('.pv-s-prev').hide();
              $('.pv-s-next').hide();
          }


          if(imgIndex == 0){
              $('#pvPrev').hide();
          }else{
              $('#pvPrev').show();
          }

          if(imgIndex == pvSmallImgLength-1){
              $('#pvNext').hide();
          }else{
              $('#pvNext').show();
          }


          pvSmallImg.removeClass('pv-s-on');
          $(this).addClass('pv-s-on');
          $('#pvSmallScroll').animate({
              'left' : (3 - imgIndex) * 56 + 'px'
          })

          var curVideoUrl = $(this).find('img').attr('videoUrl')

          if( $(this).find('img').attr('videoUrl') != 'undefined') {

              $('#openBigImg .view-img').hide();
              $('#videoWrap').show().find('#playVideo')[0].src = curVideoUrl;

          } else {

              $('#videoWrap').hide().find('#playVideo')[0].pause();
              $('#openBigImg .view-img').show().attr({
                  'src': $(this).find('img')[0].src,
                  'id': $(this).find('img')[0].id,
              });

          }
          

          var curDataType = $(this).find('img').attr('dataType');
          var curDataTypeTxt = {
              'unStage': '未处理',
              'passStage': '通过',
              'minedStage': '待定',
              'uneffectStage': '无效'
          }
          $('.view-stage').attr('dataType', curDataType).text(curDataTypeTxt[curDataType]);

      })
      $('.pv-s-on').click();//当前小图点击一下




      // 小图上3个
      $('.pv-s-prev').unbind().click(function(){
          if(parseInt($('#pvSmallScroll').css('left')) <= -168){
              $(this).show();
              $('#pvSmallScroll').animate({
                  'left' : '+=168px'
              })
          }else{
              $(this).hide();
              $('#pvSmallScroll').animate({
                  'left' : 0
              })
          }
          $('.pv-s-next').show();
      })


      // 小图下3个
      $('.pv-s-next').unbind().click(function(){
          if(parseInt($('#pvSmallScroll').css('left')) > 560 - pvScrollW){
              $(this).show();
              $('#pvSmallScroll').animate({
                  'left' : '-=168px'
              })
          }else{
              $(this).hide();
              $('#pvSmallScroll').animate({
                  'left' : 392 - pvScrollW + 'px'
              })
          }
          $('.pv-s-prev').show();
      })





      // 大图上一张
      $('#pvPrev').unbind().click(function(){
          prevImgFn();
          return false;
      })
      // 大图下一张
      $('#pvNext').unbind().click(function(){
          nextImgFn();
          return false;
      })




      // 键盘事件绑定
      document.onkeydown = function(event){
          var e = event || window.event;
          if(e && e.keyCode==37){ // 按 <--
             prevImgFn();
          }
          if(e && e.keyCode==39){ // 按 -->
             nextImgFn();
          }            
      }; 
      // 大图上一张
      function prevImgFn(){
          if($('.pv-s-on').prev('.s-img-w').length > 0){
              $('.pv-s-on').prev('.s-img-w').click();
          }
      }
      // 大图下一张
      function nextImgFn(){
          if($('.pv-s-on').next('.s-img-w').length > 0){
            $('.pv-s-on').next('.s-img-w').click();
          }
      }
    }


   

</script>
</body>
</html>
